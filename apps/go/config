#!/usr/bin/env bash

install_common() {
  # setup for posix system
  if ! has goenv; then
    echo "No goenv exist. install it." 1>&2
    return
  fi
  local version=1.12.7
  mexe goenv install $version
  mexe goenv global $version
  mexe goenv rehash
  mexe go version
}

install_msys() {
  def_install mingw-w64-x86_64-go
}
install_cygwin() {
  not_supported
}

setting_common() {
  if grep "GOPATH" ~/.works.zsh >& /dev/null; then
    return
  fi
  make_dir_if_needed $HOME/go/lib/go
  mexe "echo 'export GOPATH=\$HOME/go' >> ~/.works.zsh"
  mexe "echo 'export GOROOT=\$GOPATH/lib/go' >> ~/.works.zsh"
  mexe "echo 'export GOBIN=\$GOPATH/bin' >> ~/.works.zsh"
  mexe "echo 'add_path \$GOBIN' >> ~/.works.zsh"
  rm_dotpath
}

