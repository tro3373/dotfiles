#!/usr/bin/env bash

cat_content() {
  cat <<EOF
[InternetShortcut]
URL="$(cygpath -wa $1)"
IconFile=C:\WINDOWS\system32\SHELL32.dll
IconIndex=20
EOF
}

main() {
  only msys || exit 1
  [[ $# -ne 2 ]] && echo "Specify valid args" 1>&2 && exit 1
  [[ -e $2 ]] && echo "Already $2 exist" 1>&2 && exit 1
  local dst="$2"
  [[ $dst =~ ^.*\.lnk ]] || dst="$dst.lnk"
  # NOT WORK! FIXME! https://stackoverflow.com/questions/30028709/how-do-i-create-a-shortcut-via-command-line-in-windows
  cat_content "$1" >"$dst"
}
main "$@"
