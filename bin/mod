#!/usr/bin/env bash

# has() { command -v ${1} >& /dev/null; }
# ! has fzf && echo "Not supported." 1>&2 && exit 1
# vim "$(git status -s | cut -c4- |fzf)"

has() { command -v ${1} >&/dev/null; }
main() {
  ! has fzf && echo "No fzf exist" 1>&2 && exit 1
  # shellcheck disable=SC2016
  local files="$(
    git status -s |
      grep -E -v '^ D ' |
      fzf -m --preview 'head -100 $(echo {} |cut -c4-)' |
      cut -c4-
  )"
  [[ -z $files ]] && return
  local _vim=vim
  has nvim && _vim=nvim
  $_vim -p $files </dev/tty
}
main "$@"
